(function(e){function t(t){for(var i,s,l=t[0],o=t[1],c=t[2],p=0,u=[];p<l.length;p++)s=l[p],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&u.push(n[s][0]),n[s]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);h&&h(t);while(u.length)u.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],i=!0,l=1;l<a.length;l++){var o=a[l];0!==n[o]&&(i=!1)}i&&(r.splice(t--,1),e=s(s.s=a[0]))}return e}var i={},n={app:0},r=[];function s(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=i,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(a,i,function(t){return e[t]}.bind(null,i));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var h=o;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0e8d":function(e,t,a){"use strict";a("4835")},4835:function(e,t,a){},"4a32":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("7a23");function n(e,t,a,n,r,s){var l=Object(i["i"])("Main");return Object(i["f"])(),Object(i["b"])(l,{state:r.state},null,8,["state"])}a("4de4"),a("d3b7"),a("ac1f"),a("1276"),a("cb29"),a("a15b");var r=Object(i["o"])("data-v-273f5400");Object(i["h"])("data-v-273f5400");var s={class:"main"},l={key:0,class:"controls",style:{width:"750px"}},o=Object(i["e"])("option",{selected:"",value:"cyberpunk"},"cyberpunk",-1),c=Object(i["e"])("option",{value:"rainbows"},"rainbows",-1),h={key:0,style:{display:"inline-block"}},p={key:1,style:{display:"inline-block"}},u={style:{display:"inline-block"}},d=Object(i["e"])("br",null,null,-1),b={key:0,style:{color:"#0f8","font-size":"12px",position:"absolute","maring-top":"45px",width:"120px","margin-left":"-58px"}},f={class:"actionContainer"},y={ref:"mainCanvas",tabindex:"0"},m={class:"innerInputForm",style:{"margin-top":"-40px",background:"#6488",padding:"20px","border-radius":"50%","box-shadow":"0 0 100px 100px #6488",width:"300px"}},g={key:0,style:{color:"#8fa","font-size":"1.4em","line-height":"1em"}},O=Object(i["d"])(" You've been"),j=Object(i["e"])("br",null,null,-1),v=Object(i["e"])("span",{style:{"font-size":".8em"}},"challenged to a",-1),k=Object(i["e"])("br",null,null,-1),x=Object(i["d"])("Tetris match!"),w=Object(i["e"])("br",null,null,-1),N={key:1,style:{color:"#8fa"}},S=Object(i["d"])(" create a multiplayer"),D=Object(i["e"])("br",null,null,-1),T=Object(i["e"])("span",{style:{"font-size":"1.5em"}},"Tetris match!",-1),P=Object(i["e"])("br",null,null,-1),M=Object(i["e"])("br",null,null,-1),C=Object(i["e"])("br",null,null,-1),A=Object(i["e"])("br",null,null,-1),B=Object(i["e"])("br",null,null,-1),J=Object(i["d"])("or"),G=Object(i["e"])("br",null,null,-1),R=Object(i["e"])("br",null,null,-1),I=Object(i["d"])("play single"),L=Object(i["e"])("br",null,null,-1),K=Object(i["d"])("player mode"),z={key:1},H={key:0,style:{position:"absolute","z-index":"1000",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#28a8","box-shadow":"0 0 100px 100px #28a8",padding:"20px","border-radius":"50%","font-size":"1em","margin-top":"0px",width:"350px"}},E={key:0,style:{"margin-top":"-30px"}},F={style:{color:"#fff","text-shadow":"2px 2px 2px #000"}},U={style:{"font-size":"3em","text-shadow":"0 0 10px #fff",color:"#0ff"}},W=Object(i["e"])("br",null,null,-1),q=Object(i["d"])("players"),V=Object(i["e"])("br",null,null,-1),$=Object(i["d"])("have joined..."),_=Object(i["e"])("br",null,null,-1),Y={style:{"font-size":".6em"}},X=Object(i["e"])("br",null,null,-1),Q=Object(i["d"])(" waiting for the"),Z=Object(i["e"])("br",null,null,-1),ee=Object(i["e"])("span",{style:{"font-size":"2em"}},"game master",-1),te=Object(i["e"])("br",null,null,-1),ae=Object(i["d"])("to start the game"),ie=Object(i["e"])("br",null,null,-1),ne={key:1},re={key:1,style:{position:"absolute","z-index":"1000",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#28a8","box-shadow":"0 0 100px 100px #28a8",padding:"40px","border-radius":"50%","font-size":".8em","margin-top":"-20px"}},se={key:0},le=Object(i["e"])("br",null,null,-1),oe={key:1},ce={key:2},he={style:{position:"absolute","z-index":"1000",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#f038","box-shadow":"0 0 100px 100px #f038",padding:"40px","border-radius":"50%","font-size":".8em","text-shadow":"2px 2px 2px #000","margin-top":"-30px"}},pe=Object(i["d"])(" You've been defeated!"),ue=Object(i["e"])("br",null,null,-1),de=Object(i["e"])("br",null,null,-1),be={key:3,style:{position:"absolute","z-index":"1000",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#86c8","box-shadow":"0 0 100px 100px #86c8",padding:"40px","border-radius":"50%","font-size":".8em","text-shadow":"2px 2px 2px #000"}},fe=Object(i["d"])(" share this link with"),ye=Object(i["e"])("br",null,null,-1),me=Object(i["d"])("up to 3 opponents!"),ge=Object(i["e"])("br",null,null,-1),Oe=Object(i["e"])("br",null,null,-1),je={class:"copyButtonDiv",style:{display:"inline-block"}},ve=Object(i["e"])("br",null,null,-1),ke={key:0,style:{color:"#0f8","font-size":"20px",position:"absolute","maring-top":"45px",width:"120px","margin-left":"-58px"}},xe=Object(i["e"])("br",null,null,-1);Object(i["g"])();var we=r((function(e,t,a,n,r,we){var Ne=Object(i["i"])("Header");return Object(i["f"])(),Object(i["b"])("div",s,[1==a.state.stage?(Object(i["f"])(),Object(i["b"])("div",l,[Object(i["m"])(Object(i["e"])("select",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.state.colorMode=e}),style:{"margin-right":"10px"},onInput:t[2]||(t[2]=function(e){return r.c.focus()})},[o,c],544),[[i["k"],a.state.colorMode]]),!a.state.author||1!=a.state.stage||a.state.challengerJoined?(Object(i["f"])(),Object(i["b"])("div",h,[a.state.singlePlayerMode?Object(i["c"])("",!0):Object(i["m"])((Object(i["f"])(),Object(i["b"])("input",{key:0,type:"search","onUpdate:modelValue":t[3]||(t[3]=function(e){return a.state.playerName=e}),style:{width:"150px","font-size":"18px","margin-right":"10px",background:"#1236"},onInput:t[4]||(t[4]=function(e){return we.pollServer(1)})},null,544)),[[i["l"],a.state.playerName]]),a.state.author?(Object(i["f"])(),Object(i["b"])("div",p,[Object(i["e"])("span",{ref:"gamelink",class:"gamelink",innerHTML:we.processedGameLink,style:{"font-size":".75em",background:"#001",display:"inline-block"}},null,8,["innerHTML"]),Object(i["e"])("div",u,[Object(i["e"])("button",{style:{"font-size":"14px","margin-left":"5px",padding:"5px","padding-left":"30px","padding-right":"1=5px","margin-top":"0px","background-image":"url(https://lookie.jsbot.net/uploads/19npcK.png)","background-repeat":"no-repeat","background-position":"5px 2px","text-shadow":"1px 1px 2px #000","background-size":"20px 20px",border:"1px solid #8888","background-color":"#6fa8","border-radius":"8px","padding-top":"3"},onClick:t[5]||(t[5]=function(e){return we.copy()}),class:{copied:a.state.linkCopied}},"copy",2),d,a.state.linkCopied?(Object(i["f"])(),Object(i["b"])("span",b,"link copied!")):Object(i["c"])("",!0)])])):Object(i["c"])("",!0)])):Object(i["c"])("",!0)])):Object(i["c"])("",!0),Object(i["e"])(Ne,{state:a.state},null,8,["state"]),Object(i["e"])("div",f,[Object(i["e"])("canvas",y,null,512),a.state.stage&&2!=a.state.stage?Object(i["c"])("",!0):(Object(i["f"])(),Object(i["b"])("div",{key:0,class:["inputForm",{noyellow:"cyberpunk"==a.state.colorMode}]},[Object(i["e"])("div",m,[a.state.stage?(Object(i["f"])(),Object(i["b"])("div",g,[O,j,v,k,x,w])):Object(i["c"])("",!0),a.state.stage?Object(i["c"])("",!0):(Object(i["f"])(),Object(i["b"])("div",N,[S,D,T,P])),M,Object(i["m"])(Object(i["e"])("input",{type:"search",maxlength:"16",placeholder:"enter your name","onUpdate:modelValue":t[6]||(t[6]=function(e){return a.state.playerName=e}),autocomplete:"off",ref:"userNameField",onKeyup:t[7]||(t[7]=Object(i["n"])((function(e){return a.state.stage?we.joinGame():we.createGame()}),["enter"]))},null,544),[[i["l"],a.state.playerName]]),C,a.state.playerName?(Object(i["f"])(),Object(i["b"])("button",{key:2,class:["createGameButton",{disabled:!a.state.playerName.length}],disabled:!a.state.playerName.length,style:{position:"absolute",width:"250px",transform:"translatex(-50%)","margin-top":"20px"},onClick:t[8]||(t[8]=function(e){return a.state.stage?we.joinGame():we.createGame()}),innerHTML:a.state.stage?"join game":"create game"},null,10,["disabled","innerHTML"])):Object(i["c"])("",!0),A,B,J,G,R,Object(i["e"])("button",{onClick:t[9]||(t[9]=function(e){return we.launchSinglePlayer()})},[I,L,K])])],2)),a.state.gameActuallyPlaying?Object(i["c"])("",!0):(Object(i["f"])(),Object(i["b"])("div",z,[a.state.author||1!=a.state.stage?Object(i["c"])("",!0):(Object(i["f"])(),Object(i["b"])("div",H,[we.countdown<=0?(Object(i["f"])(),Object(i["b"])("div",E,[Object(i["e"])("div",F,[Object(i["e"])("span",U,[Object(i["d"])(Object(i["j"])(we.playerJoinedCount),1),W]),q,V,$,_,Object(i["e"])("span",Y,[Object(i["d"])(Object(i["j"])(Array(1+(8*r.t|0)%8).fill(" <").join("")+Array(1+(8*r.t|0)%8).fill("> ").join("")),1),X,Q,Z,ee,te,ae,ie,Object(i["d"])(" "+Object(i["j"])(Array(1+(8*r.t|0)%8).fill(" <").join("")+Array(1+(8*r.t|0)%8).fill("> ").join("")),1)])])])):(Object(i["f"])(),Object(i["b"])("div",ne,[Object(i["e"])("div",{class:{noyello:"cyberpunk"==a.state.colorMode},style:"transform: scale("+(.1+r.t%1*20)+"); opacity: "+(1-r.t%1),innerHTML:we.countdown},null,14,["innerHTML"])]))])),a.state.author&&1==a.state.stage&&a.state.challengerJoined?(Object(i["f"])(),Object(i["b"])("div",re,[we.countdown<=0?(Object(i["f"])(),Object(i["b"])("div",se,[Object(i["d"])(Object(i["j"])(we.playerJoinedCount)+" players have joined...",1),le,Object(i["e"])("button",{style:{background:"linear-gradient(135deg, #0ff, #80f)",color:"#000","margin-top":"10px"},onClick:t[10]||(t[10]=function(e){return we.playGame()}),ref:"startGameButton"},"start game",512)])):(Object(i["f"])(),Object(i["b"])("div",oe,[Object(i["e"])("div",{style:"transform: scale("+(.1+r.t%1*20)+"); opacity: "+(1-r.t%1),innerHTML:we.countdown},null,12,["innerHTML"])]))])):Object(i["c"])("",!0)])),1!=a.state.stage||a.state.alive?Object(i["c"])("",!0):(Object(i["f"])(),Object(i["b"])("div",ce,[Object(i["e"])("div",he,[pe,ue,de,Object(i["e"])("button",{onClick:t[11]||(t[11]=function(e){return we.reload()})},"re-start")])])),a.state.author&&1==a.state.stage&&!a.state.challengerJoined?(Object(i["f"])(),Object(i["b"])("div",be,[fe,ye,me,ge,Object(i["e"])("span",{ref:"gamelink",class:"gamelink",innerHTML:we.processedGameLink,style:{background:"#001"}},null,8,["innerHTML"]),Oe,Object(i["e"])("div",je,[Object(i["e"])("button",{style:{"font-size":"18px","margin-left":"5px",padding:"15px","padding-left":"50px","padding-right":"10px","margin-top":"10px","background-image":"url(https://lookie.jsbot.net/uploads/19npcK.png)","background-repeat":"no-repeat","background-position":"5px 5px","text-shadow":"1px 1px 2px #000","background-size":"40px 40px",border:"1px solid #8888","background-color":"#6fa8","border-radius":"8px"},onClick:t[12]||(t[12]=function(e){return we.copy()}),class:{copied:a.state.linkCopied}},"copy",2),ve,a.state.linkCopied?(Object(i["f"])(),Object(i["b"])("span",ke,"link copied!")):Object(i["c"])("",!0)]),xe])):Object(i["c"])("",!0)])])})),Ne=(a("99af"),a("d81d"),a("4057"),a("2909")),Se=(a("96cf"),a("1da1")),De=Object(i["o"])("data-v-a044c876");Object(i["h"])("data-v-a044c876");var Te={class:"header"},Pe=Object(i["e"])("a",{href:"javascript:window.location.href = window.location.origin"},[Object(i["e"])("div",{class:"headerText"},[Object(i["d"])("TETRIS"),Object(i["e"])("br"),Object(i["d"])("THE NEXT GENERATION")])],-1),Me={ref:"headerCanvas"};Object(i["g"])();var Ce=De((function(e,t,a,n,r,s){return Object(i["f"])(),Object(i["b"])("div",Te,[Pe,Object(i["e"])("canvas",Me,null,512)])})),Ae={name:"Header",props:["state"],data:function(){return{t:0,S:Math.sin,C:Math.cos,x:null,c:null}},computed:{},methods:{Draw:function(){var e,t,a,i,n,r,s,l,o,c,h,p,u,d,b,f,y,m,g,O,j,v,k,x,w,N=this,S=this.t,D=this.S,T=this.C,P=this.x,M=this.c;for(o=function(e,t,a,n){g=D(i=(k=(v=Math).atan2)(g,O)+e)*(w=(x=v.hypot)(g,O)),O=T(i)*w,O=D(i=k(O,j)+t)*(w=x(O,j)),j=T(i)*w,g=D(i=k(g,j)+a)*(w=x(g,j)),j=T(i)*w,n&&(g+=u,O+=d,j+=b)},e=[],t=6;t--;)for(a=4;a--;)e=[].concat(Object(Ne["a"])(e),[[(n=[D(i=2*Math.PI/4*a+Math.PI/4)*Math.pow(2,.5)/2,T(i)*Math.pow(2,.5)/2,.5])[t%3]*(r=t<3?1:-1),n[(t+1)%3]*r,n[(t+2)%3]*r]]);s=[[[-.5,-1,0],[-.5,0,0],[-.5,1,0],[.5,1,0]],[[.5,-1,0],[.5,0,0],[.5,1,0],[-.5,1,0]],[[-1,0,0],[0,0,0],[1,0,0],[0,1,0]],[[-1.5,0,0],[-.5,0,0],[.5,0,0],[1.5,0,0]],[[-.5,-1,0],[-.5,0,0],[.5,0,0],[.5,1,0]],[[.5,-1,0],[.5,0,0],[-.5,0,0],[-.5,1,0]],[[-.5,-.5,0],[.5,-.5,0],[.5,.5,0],[-.5,.5,0]]],M.width=M.clientWidth,P.fillStyle="#000",P.clearRect(0,0,l=M.width,l),P.lineJoin=P.lineCap="round",c=S,h=-S/2,p=S,u=0,d=0,b=5,s.map((function(t,a){t.map((function(t){f=t[0],y=t[1],m=t[2],e.map((function(e,t){if(g=e[0]+f,O=e[1]+y,j=e[2]+m,o(c*(a%2?1:-1),h*(a%2?1:-1.5),p,1),t%4||P.beginPath(),P.lineTo(g/j*100+((-3+a)*M.width/7-1e3*T(S/3)+M.width/2*99)%M.width,M.height/2+O/j*100),t%4==3){switch(N.state.colorMode){case"cyberpunk":P.strokeStyle="hsla(".concat(170,",75%,",50,"%,.8)"),P.fillStyle="hsla(".concat(170,",75%,",50,"%,.3)");break;case"rainbows":P.strokeStyle="hsla(".concat(360/7*(a-1),",75%,50%,.8)"),P.fillStyle="hsla(".concat(360/7*(a-1),",75%,50%,.3)");break}P.closePath(),P.lineWidth=4/j,P.stroke(),P.fill()}}))}))})),this.t+=1/60,requestAnimationFrame(this.Draw)}},mounted:function(){var e=this;this.$nextTick((function(){e.c=e.$refs.headerCanvas,e.x=e.c.getContext("2d"),e.t=0,e.c.width=e.c.clientWidth,e.c.height=e.c.clientHeight,e.Draw()}))}};a("65b4");Ae.render=Ce,Ae.__scopeId="data-v-a044c876";var Be=Ae,Je={name:"Main",props:["state"],components:{Header:Be},data:function(){return{t:0,S:Math.sin,C:Math.cos,x:null,currentPiece:null,swapped:!1,boardBG:new Image,tempBoard:[],initDropFreq:40,dropFreq:40,rowsCompleted:0,c:null,spaceKey:!1,leftKey:!1,upKey:!1,rightKey:!1,downKey:!1,tabKey:!1,pieceMoveTimer:0,pieceRotateTimer:0,piceMoveInterval:.15,pieceManualDropTimer:0,piecManualDropInterval:.02,B:[],G:[],R:null,nextPieceIdx:7*Math.random()|0,stage:null}},computed:{countdown:function(){return this.state.countdownTimer-this.t|0},playerJoinedCount:function(){var e=0;return e+=this.state.playerAName?1:0,e+=this.state.playerBName?1:0,e+=this.state.playerCName?1:0,e+=this.state.playerDName?1:0,e<2&&(this.state.challengerJoined=!1),e},processedGameLink:function(){return this.state.gameLink}},methods:{launchSinglePlayer:function(){this.state.singlePlayerMode=!0,this.startGame()},spawnPiece:function(e,t){var a=this;this.tempBoard=JSON.parse(JSON.stringify(this.state.boardData));var i=this.nextPieceIdx;this.nextPieceIdx=this.B.length*Math.random()|0;var n=JSON.parse(JSON.stringify(this.B))[i].map((function(a){return[Math.round(e+a[0]),Math.round(t+a[1]),i]}));this.canDo(n)?(this.currentPiece=n,this.state.boardData=this.state.boardData.map((function(e,t){var i=t%10,n=(t/10|0)-6;return a.currentPiece.map((function(t){t[0]==i&&t[1]==n&&(e[0]=t[2]+1,e[1]=0)})),e}))):this.state.alive=!1},checkRowCompletion:function(){for(var e,t=26;t--;){e=!0;for(var a=0;a<10;++a)this.state.boardData[10*t+a][0]||(e=!1);if(e){this.rowsCompleted++,this.dropFreq=this.initDropFreq/(1+this.rowsCompleted/20),this.rowsCompleted>this.state.highScore&&(this.state.highScore=this.rowsCompleted);for(var i=0;i<10;++i)this.state.boardData[10*t+i][1]=1}}},canDo:function(e){var t=!0;return this.tempBoard.map((function(a,i){var n=i%10,r=(i/10|0)-6;e.map((function(e){(e[0]==n&&e[1]==r&&a[0]||e[1]>19||e[0]<0||e[0]>9)&&(t=!1)}))})),t},advancePiece:function(){var e=this;if(this.currentPiece){var t=JSON.parse(JSON.stringify(this.currentPiece)).map((function(e){return[Math.round(e[0]),Math.round(e[1]+1),e[2]]}));this.canDo(t)?(this.currentPiece=t,this.state.boardData=JSON.parse(JSON.stringify(this.tempBoard)),this.state.boardData=this.state.boardData.map((function(t,a){var i=a%10,n=(a/10|0)-6;return e.currentPiece.map((function(e){e[0]==i&&e[1]==n&&(t[0]=e[2]+1,t[1]=0)})),t}))):(this.swapped=!1,this.state.boardData=this.state.boardData.map((function(t,a){var i=a%10,n=(a/10|0)-6;return e.currentPiece.map((function(e){e[0]==i&&e[1]==n&&(t[0]=e[2]+1,t[1]=0)})),t})),this.currentPiece=null,this.tempBoard=JSON.parse(JSON.stringify(this.state.boardData)),this.checkRowCompletion())}},syncBoard:function(){this.state.boardData=Array(260).fill().map((function(e){return[0,0]})),this.dropFreq=this.initDropFreq,this.rowsCompleted=0,this.tempBoard=Array(260).fill().map((function(e){return[0,0]}))},copy:function(){this.state.copyToClipboard(this.$refs.gamelink)},createGame:function(){this.state.createGame()},joinGame:function(){var e=this;this.state.playerNumber="",this.state.stage=1,this.state.alive=!0,this.syncBoard(),this.pollServer(),this.$nextTick((function(){return e.Draw()}))},drawNextPiece:function(e,t,a,i){var n,r,s,l,o,c,h,p,u,d,b=this,f=this.t,y=this.S,m=this.C,g=this.x,O=this.c;g.lineJoin=g.lineCap="round",t+=70,o=f/4,c=-f/1.5,h=2*f;var j,v,k,x,w,N=(O.height-O.height/20)*i;p=0,u=0,d=Math.max(4,16-N/60),l=function(e,t,a,i){n=y(k=(v=(j=Math).atan2)(n,r)+e)*(w=(x=j.hypot)(n,r)),r=m(k)*w,r=y(k=v(r,s)+t)*(w=x(r,s)),s=m(k)*w,n=y(k=v(n,s)+a)*(w=x(n,s)),s=m(k)*w,i&&(n+=p,r+=u,s+=d)},this.B.map((function(i,p){p==a&&i.map((function(a){var i=a[0],u=a[1],d=a[2];b.G.map((function(a,f){if(n=a[0]+i,r=a[1]+u,s=a[2]+d,l(o*(p%2?1:-1),c*(p%2?1:-1.5),h,1),f%4||g.beginPath(),g.lineTo(e+N/4.5-100+n/s*200,t+N/8-70+r/s*200),f%4==3){switch(b.state.colorMode){case"cyberpunk":g.strokeStyle="hsla(".concat(170,",75%,",60,"%,.8)"),g.fillStyle="hsla(".concat(170,",75%,",60,"%,.3)");break;case"rainbows":g.strokeStyle="hsla(".concat(360/7*p,",75%,50%,.8)"),g.fillStyle="hsla(".concat(360/7*p,",75%,50%,.3)");break}g.closePath(),g.lineWidth=5/s,g.stroke(),g.fill()}}))}))}))},drawOpponents:function(e,t){var a,i=this,n=this.t,r=this.S,s=(this.C,this.x),l=this.c,o=.4,c=(l.height-l.height/20)*o,h=t+c/4;if(this.state.singlePlayerMode)return s.font=c/10+'px "Varela Round"',s.fillStyle="#0f8",s.fillText("high score",e+c/4,t+c/8*2),s.fillStyle="#fff",s.fillText(this.state.highScore,e+c/2-c/32,t+c/8*3),s.fillStyle="#0f8",s.fillText("rows completed",e+c/6,t+c/8*5),s.fillStyle="#fff",void s.fillText(this.rowsCompleted,e+c/2-c/32,t+c/8*6);this.state.challengerJoined?function(){for(var o=.2,c=(l.height-l.height/20)*o,h=t+c/4,p=function(l){var o=!0;switch(l){case 0:i.state.playerAName||(o=!1);break;case 1:i.state.playerBName||(o=!1);break;case 2:i.state.playerCName||(o=!1);break;case 3:i.state.playerDName||(o=!1);break}var p=(l%2+.3)*c*1.05,u=(l/2|0)*c*1.22;a=p+e+c/32-c/4;var d=void 0;if(t=u+h,o){var b=[];switch(l){case 0:b=i.state.playerAdata.boardData;break;case 1:b=i.state.playerBdata.boardData;break;case 2:b=i.state.playerCdata.boardData;break;case 3:b=i.state.playerDdata.boardData;break}s.drawImage(i.boardBG,a,t,c/2,c);var f=c/1e3;b.map((function(a,l){if(a[0]){var o=p+l%10*c/20+c/35-c/4,h=((l/10|0)-6)*c/20-c/35;if((l/10|0)-6>=0){switch(i.state.colorMode){case"cyberpunk":s.fillStyle="hsla(".concat(170,",75%,",50*(a[1]?a[1]-1:0)*r(50*n)+25+10*(a[0]-1),"%,.8)");break;case"rainbows":s.fillStyle="hsla(".concat(360/7*(a[0]-1),",75%,").concat(50*(a[1]?a[1]-1:0)*r(50*n)+50,"%,.8)");break}s.fillRect(e+o+f,t+h+c/40+f,c/20-2*f,c/20-2*f)}}})),s.strokeStyle="#aff6",s.lineWidth=2,s.strokeRect(a,t,c/2,c);var y,m,g=!0;switch(l){case 0:g=i.state.playerAdata.alive;break;case 1:g=i.state.playerBdata.alive;break;case 2:g=i.state.playerCdata.alive;break;case 3:g=i.state.playerDdata.alive;break}switch(g||(s.fillStyle="#f248",s.fillRect(a,t,c/2,c)),s.font=c/10+'px "Varela Round"',i.state.colorMode){case"cyberpunk":s.fillStyle="#0f8";break;case"rainbows":s.fillStyle="#ff0";break;default:s.fillStyle="#0f8"}switch(l){case 0:d=i.state.playerAName;break;case 1:d=i.state.playerBName;break;case 2:d=i.state.playerCName;break;case 3:d=i.state.playerDName;break}switch(d='"'+d+'"',s.fillStyle="#ff0",s.fillText(d,a,t-c/28),s.font=c/10+'px "Varela Round"',l){case 0:y=i.state.playerAdata.highScore;break;case 1:y=i.state.playerBdata.highScore;break;case 2:y=i.state.playerCdata.highScore;break;case 3:y=i.state.playerDdata.highScore;break}switch(s.fillStyle="#0f8",s.fillText("high",a+c/1.9,t+c/10),s.fillText("score",a+c/1.9,t+c/10*2),s.fillStyle="#fff",s.fillText(y,a+c/1.75,t+c/10*3),l){case 0:m=i.state.playerAdata.rowsCompleted;break;case 1:m=i.state.playerBdata.rowsCompleted;break;case 2:m=i.state.playerCdata.rowsCompleted;break;case 3:m=i.state.playerDdata.rowsCompleted;break}s.fillStyle="#0f8",s.fillText("current",a+c/1.9,t+c/10*6),s.fillText("rows",a+c/1.9,t+c/10*7),s.fillStyle="#fff",s.fillText(m,a+c/1.75,t+c/10*8)}else s.fillStyle="#2228",s.fillRect(a,t,c/2,c),s.strokeStyle="#8886",s.lineWidth=1,s.strokeRect(a,t,c/2,c),d="not joined",s.font=c/10+'px "Varela Round"',s.fillStyle="#888",s.fillText(d,a,t-c/28)},u=0;u<4;++u)p(u)}():(t=h,s.font=c/8+'px "Varela Round"',s.fillStyle="#fff8",s.fillText("awaiting",e+c/3.25,t+c/4),s.fillText("challenger(s)",e+c/5,t+c/2.5),s.font=c/4+'px "Varela Round"',s.fillStyle="#4688",s.fillText("["+Array((8*n|0)%8).fill(".").join("")+"]",e+c/2.1-(8*n|0)%8*.035*c,t+c/1.45))},pollServer:function(e){var t=this;return Object(Se["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={playerNumber:t.state.playerNumber,gameID:t.state.gameID,playerName:t.state.playerName,gamedata:{boardData:t.state.boardData,highScore:t.state.highScore,rowsCompleted:t.rowsCompleted,alive:t.state.alive,playerName:t.state.playerName,playerNumber:t.state.playerNumber}},a.next=3,fetch(t.state.baseURL+"/sync.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then((function(e){return e.json()})).then((function(a){if(a)if("error - game full"==a[0])alert("OOPS! game is full... you can create a new game though!"),window.location.href=window.location.origin;else{a[2]&&(+a[2].playing||(t.state.gameActuallyPlaying=!1),!+a[2].playing||t.state.gameActuallyPlaying||t.state.countdownTimer||(t.t=1,t.state.countdownTimer=t.t+6)),t.state.playerNumber=a[0];var i,n=a[2],r=""==n.gamedataA?[]:JSON.parse(n.gamedataA),s=""==n.gamedataB?[]:JSON.parse(n.gamedataB),l=""==n.gamedataC?[]:JSON.parse(n.gamedataC),o=""==n.gamedataD?[]:JSON.parse(n.gamedataD);switch("undefined"==typeof r.playerNumber&&(t.state.playerAName="",t.state.playerAdata={boardData:[]}),"undefined"==typeof s.playerNumber&&(t.state.playerBName="",t.state.playerBdata={boardData:[]}),"undefined"==typeof l.playerNumber&&(t.state.playerCName="",t.state.playerCdata={boardData:[]}),"undefined"==typeof o.playerNumber&&(t.state.playerDName="",t.state.playerDdata={boardData:[]}),t.state.author&&(i=r.playerName),t.state.playerNumber){case"B":i=s.playerName;break;case"C":i=l.playerName;break;case"D":i=o.playerName;break;default:t.state.author||(i="");break}t.state.playerAdata=r,t.state.playerBdata=s,t.state.playerCdata=l,t.state.playerDdata=o,("undefined"!=typeof i&&!e&&i.length&&t.t-t.state.lastNameUpdateTimer>3||t.t<3)&&(t.state.playerName=i,t.state.playerAdata=r),"undefined"!=typeof r.playerName&&(t.state.playerAName=r.playerName),"undefined"!=typeof s.playerName&&(t.state.playerBName=s.playerName),"undefined"!=typeof l.playerName&&(t.state.playerCName=l.playerName),"undefined"!=typeof o.playerName&&(t.state.playerDName=o.playerName),(s.playerNumber||l.playerNumber||o.playerNumber)&&(t.state.challengerJoined=!0),e?t.state.lastNameUpdateTimer=t.t:setTimeout((function(){t.pollServer()}),250)}}));case 3:a.sent;case 4:case"end":return a.stop()}}),a)})))()},Draw:function(){var e,t,a,i,n,r,s,l,o,c,h,p,u,d,b,f,y,m,g=this,O=this.t,j=this.S,v=this.C,k=this.x,x=this.c;if(function(e,t,i,n){h=j(a=(b=(d=Math).atan2)(h,p)+e)*(y=(f=d.hypot)(h,p)),p=v(a)*y,p=j(a=b(p,u)+t)*(y=f(p,u)),u=v(a)*y,h=j(a=b(h,u)+i)*(y=f(h,u)),u=v(a)*y,n&&(h+=s,p+=l,u+=o)},!this.t){for(e=6;e--;)for(t=4;t--;)this.G=[].concat(Object(Ne["a"])(this.G),[[(i=[j(a=2*Math.PI/4*t+Math.PI/4)*Math.pow(2,.5)/2,v(a)*Math.pow(2,.5)/2,.5])[e%3]*(n=e<3?1:-1),i[(e+1)%3]*n,i[(e+2)%3]*n]]);this.B=[[[-.5,-1,0],[-.5,0,0],[-.5,1,0],[.5,1,0]],[[.5,-1,0],[.5,0,0],[.5,1,0],[-.5,1,0]],[[-1,0,0],[0,0,0],[1,0,0],[0,1,0]],[[-1.5,0,0],[-.5,0,0],[.5,0,0],[1.5,0,0]],[[-.5,-1,0],[-.5,0,0],[.5,0,0],[.5,1,0]],[[.5,-1,0],[.5,0,0],[-.5,0,0],[-.5,1,0]],[[-.5,-.5,0],[.5,-.5,0],[.5,.5,0],[-.5,.5,0]]]}switch(k.lineJoin=k.lineCap="round",x.width=x.clientWidth,x.height=x.clientHeight,k.fillStyle="#000",k.clearRect(0,0,r=x.width,r),O,-O/2,O,s=0,l=0,o=40,m=x.height-x.height/20,this.state.stage){case 0:break;case 1:c=x.width/2-m/2,k.fillStyle="#011a",k.drawImage(this.boardBG,c,m/40,m/2,m),k.strokeStyle="#aff6",k.lineWidth=1,k.strokeRect(c,m/40,m/2,m);var w=m/500;if(this.state.boardData=this.state.boardData.map((function(e,t){if(e[0]){var a=t%10*m/20,i=((t/10|0)-6)*m/20;if((t/10|0)-6>=0){switch(g.state.colorMode){case"cyberpunk":k.fillStyle="hsla(".concat(170,",75%,",50*(e[1]?e[1]-1:0)*j(50*O)+25+10*(e[0]-1),"%,.8)");break;case"rainbows":k.fillStyle="hsla(".concat(360/7*(e[0]-1),",75%,").concat(50*(e[1]?e[1]-1:0)*j(50*O)+50,"%,.8)");break}k.fillRect(c+a+w,i+m/40+w,m/20-2*w,m/20-2*w)}}if(e[1]&&(e[1]+=.018),e[1]>=2){for(var n=t+10;(n-=10)>=20;)n>=10&&(g.state.boardData[n][0]=g.state.boardData[n-10][0],g.state.boardData[n][1]=g.state.boardData[n-10][1]);e[1]=0}return e})),k.fillStyle="#102a",k.fillRect(c+m/2+m/32,m/40,m/2-m/16,m/2-m/16),k.strokeStyle="#aaf6",k.lineWidth=1,k.strokeRect(c+m/2+m/32,m/40,m/2-m/16,m/2-m/16),k.font=Math.pow(m,.9)/12+'px "Varela Round"',k.fillStyle="#86fc",k.fillText("next piece",c+m/2+m/12+(m/2-m/16)/2.3-m/9,m/11-m/20+m/40),this.drawNextPiece(c+m/2+m/32+100,m/16+m/10-m/20,this.nextPieceIdx,1),k.fillStyle="#102a",k.fillRect(c+m/2+m/32,m/2-m/16+m/10-m/20,m/2-m/16,m/2+m/100+m/40),k.strokeStyle="#aaf6",k.lineWidth=1,k.strokeRect(c+m/2+m/32,m/2-m/16+m/10-m/20,m/2-m/16,m/2+m/64+m/40),k.fillStyle="#86fc",this.state.challengerJoined&&(k.font=Math.pow(m,.9)/16+'px "Varela Round"',k.fillText("challengers",c+m/1.8+m/32+m/2/2.3-m/7,m/2+m/14-m/20)),this.drawOpponents(c+m/2+m/30,m/2-m/16+m/10-m/20+m/40),!(this.state.singlePlayerMode&&this.state.alive||this.state.challengerJoined&&this.state.gameActuallyPlaying&&this.state.alive)||(60*O|0)%(0|this.dropFreq)||this.advancePiece(),k.fillStyle="#2466",null!=this.currentPiece&&(this.state.singlePlayerMode&&this.state.alive||this.state.challengerJoined&&this.state.gameActuallyPlaying&&this.state.alive)){var N=JSON.parse(JSON.stringify(this.currentPiece));do{N=N.map((function(e){return e[1]++,e}))}while(this.canDo(N));Array(260).fill().map((function(e,t){var a=t%10*m/20,i=((t/10|0)-6)*m/20;N.map((function(e){t%10==e[0]&&(t/10|0)-6==e[1]-1&&k.fillRect(c+a+w,i+m/40+w,m/20-2*w,m/20-2*w)}))}))}if(this.state.singlePlayerMode&&this.state.gameActuallyPlaying&&this.state.alive||this.state.challengerJoined&&this.state.gameActuallyPlaying&&this.state.alive)if(null!=this.currentPiece){if(this.spaceKey&&null!=this.currentPiece){do{this.currentPiece=this.currentPiece.map((function(e){return e[1]++,e}))}while(this.canDo(this.currentPiece));this.state.boardData=JSON.parse(JSON.stringify(this.tempBoard)),this.state.boardData=this.state.boardData.map((function(e,t){var a=t%10,i=(t/10|0)-6;return g.currentPiece.map((function(t){t[0]==a&&t[1]-1==i&&(e[0]=t[2]+1,e[1]=0)})),e})),this.currentPiece=null,this.spaceKey=!1,this.tempBoard=JSON.parse(JSON.stringify(this.state.boardData)),this.checkRowCompletion()}if(this.leftKey&&null!=this.currentPiece&&this.pieceMoveTimer<O){var S=JSON.parse(JSON.stringify(this.currentPiece)).map((function(e){return e[0]--,e}));this.canDo(S)&&(this.currentPiece=S,this.pieceMoveTimer=this.t+this.piceMoveInterval)}if(this.rightKey&&null!=this.currentPiece&&this.pieceMoveTimer<O){var D=JSON.parse(JSON.stringify(this.currentPiece)).map((function(e){return e[0]++,e}));this.canDo(D)&&(this.currentPiece=D,this.pieceMoveTimer=this.t+this.piceMoveInterval)}if(this.downKey&&this.pieceManualDropTimer<O&&null!=this.currentPiece&&(this.advancePiece(),this.pieceManualDropTimer=this.t+this.piecManualDropInterval),this.upKey&&null!=this.currentPiece&&6!=this.currentPiece[0][2]&&this.pieceRotateTimer<O){var T,P=this.currentPiece[1][0],M=this.currentPiece[1][1],C=JSON.parse(JSON.stringify(this.currentPiece)).map((function(e){T=e[0];e[0],e[1];var t=Math.atan2(e[0]-P,e[1]-M)+Math.PI/2,a=Math.hypot(e[0]-P,e[1]-M);return e[0]=Math.round(P+j(t)*a),e[1]=Math.round(M+v(t)*a),e}));if(this.canDo(C))this.currentPiece=C,this.pieceRotateTimer=this.t+2*this.piceMoveInterval;else if(T>=5){var A=0,B=!1;do{A++,C=C.map((function(e){return e[0]--,e}))}while(!(B=this.canDo(C))&&A<3);B&&(this.currentPiece=C,this.pieceRotateTimer=this.t+2*this.piceMoveInterval)}else if(T<=5){var J=0,G=!1;do{J++,C=C.map((function(e){return e[0]++,e}))}while(!(G=this.canDo(C))&&J<3);G&&(this.currentPiece=C,this.pieceRotateTimer=this.t+2*this.piceMoveInterval)}}null!=this.currentPiece&&(this.state.boardData=JSON.parse(JSON.stringify(this.tempBoard)),this.state.boardData=this.state.boardData.map((function(e,t){var a=t%10,i=(t/10|0)-6;return g.currentPiece.map((function(t){t[0]==a&&t[1]==i&&(e[0]=t[2]+1,e[1]=0)})),e})))}else this.state.boardData.filter((function(e){return e[1]})).length||this.spawnPiece(4,-2);this.t+=1/60,requestAnimationFrame(this.Draw);break;case 2:break}},launchGame:function(){var e=this;this.stage=0,this.state.countdownTimer=0,this.t=0,this.pollServer(),this.$nextTick((function(){return e.Draw()}))},startGame:function(){var e=this;this.state.singlePlayerMode?history.pushState(0,0,window.location.origin+"/game"):history.pushState(0,0,window.location.origin+"/game/"+this.state.decToAlpha(this.state.gameID)+"/a"),this.state.stage=1,this.state.countdownTimer=0,this.t=0,this.state.singlePlayerMode?(this.state.gameActuallyPlaying=!1,this.state.countdownTimer=this.t+6):this.pollServer(),this.$nextTick((function(){return e.Draw()})),this.syncBoard()},playGame:function(){var e=this;this.state.gameActuallyPlaying=!1;var t={gameID:this.state.gameID};fetch(this.state.baseURL+"/startGame.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(t){t[0]!=="started game# "+e.state.gameID&&console.log("error starting game :(")}))},setupListeners:function(){var e=this;document.getElementsByTagName("body")[0].addEventListener("keydown",(function(t){switch(t.keyCode){case 9:e.tabKey=!0;break;case 37:e.leftKey=!0;break;case 38:e.upKey=!0;break;case 39:e.rightKey=!0;break;case 40:e.downKey=!0;break;case 32:e.spaceKey=!0;break}})),document.getElementsByTagName("body")[0].addEventListener("keyup",(function(t){switch(e.pieceMoveTimer=0,e.pieceRotateTimer=0,t.keyCode){case 9:e.tabKey=!1;break;case 37:e.leftKey=!1;break;case 38:e.upKey=!1;break;case 39:e.rightKey=!1;break;case 40:e.downKey=!1;break;case 40:e.spaceKey=!1;break}}))},reload:function(){this.syncBoard(),this.state.alive=!0,this.currentPiece=null,this.dropFreq=this.initDropFreq,this.rowsCompleted=0}},watch:{"state.gameActuallyPlaying":function(e){e&&this.reload()},"state.gameLink":function(e){var t=this;e.length&&this.$nextTick((function(){t.$nextTick((function(){return t.startGame()}))}))},countdown:function(e){!e&&this.playerJoinedCount>1&&(!this.state.author||1!=this.state.stage||this.state.challengerJoined)&&(this.state.gameActuallyPlaying=!0),this.state.singlePlayerMode&&!e&&(this.state.gameActuallyPlaying=!0)}},mounted:function(){var e=this;this.c=this.$refs.mainCanvas,this.x=this.c.getContext("2d"),this.t=0,this.c.width=this.c.clientWidth,this.c.height=this.c.clientHeight,this.boardBG.src="https://lookie.jsbot.net/uploads/rjc4W.png",this.state.author&&(this.gameActuallyPlaying=!1),this.$nextTick((function(){1!=e.state.stage&&e.$refs.userNameField.focus(),e.state.singlePlayerMode&&e.launchSinglePlayer()})),this.setupListeners()}};a("0e8d");Je.render=we,Je.__scopeId="data-v-273f5400";var Ge=Je,Re={name:"App",components:{Main:Ge},data:function(){return{state:{gameStarted:!1,createGame:null,getGameData:null,baseURL:"https://gummier-fish.000webhostapp.com/b/games/tetris/",gameLink:"",author:!1,receivedGameData:{},playerName:"",singlePlayerMode:!1,alive:!0,highScore:0,lastNameUpdateTimer:0,decToAlpha:null,alphaToDec:null,boardData:[],gameActuallyPlaying:!0,countdownTimer:null,actuallyStartGame:null,colorMode:Math.random()<.5?"rainbows":"cyberpunk",playerAName:"",playerBName:"",playerCName:"",playerDName:"",playerAdata:{boardData:[]},playerBdata:{boardData:[]},playerCdata:{boardData:[]},playerDdata:{boardData:[]},playerNumber:"",gameID:-1,mode:0,copyToClipboard:null,setBG:null,linkeCopied:!1,challengerJoined:!1}}},methods:{copyToClipboard:function(e){var t=this,a=document.createElement("input");a.style.position="absolute",a.style.opacity="0",a.setAttribute("type","text"),a.value=this.state.gameLink,document.getElementsByTagName("body")[0].appendChild(a),a.select(),a.setSelectionRange(0,99999),document.execCommand("copy"),a.parentNode.removeChild(a),this.state.linkCopied=!0,setTimeout((function(){t.state.linkCopied=!1}),1200)},alphaToDec:function(e){var t,a,i=0,n=0;while(""!=e)t=e[e.length-1],e=e.substring(0,e.length-1),a=t.charCodeAt(0)<58?t:t.charCodeAt(0)-(t.charCodeAt(0)>96?87:29),n+=a*Math.pow(62,i),i++;return n},decToAlpha:function(e){var t,a="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i="";while(e)i=a[0|Math.round(62*(e/62-(t=e/62|0)))]+i,e=t;return""==i?"0":i},createGame:function(){var e=this,t={gamedata:{playerName:this.state.playerName,playerNumber:"A"}};fetch(this.state.baseURL+"/createGame.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(t){t&&(e.state.author=!0,e.state.playerNumber="A",e.state.gameID=t[0],e.state.gameLink=e.state.baseURL+"/game/"+e.decToAlpha(t[0]))}))},getMode:function(){var e=window.location.pathname.split("/").filter((function(e){return e}));if(e.length>1)switch(e[0]){case"game":this.state.gameID=this.alphaToDec(e[1]),"a"==e[2]?(this.state.author=!0,this.state.stage=1,this.state.gameLink=this.state.baseURL+"/game/"+this.decToAlpha(this.state.gameID),this.state.playerNumber="A"):e[1]&&(this.state.stage=2);break}else"game"==e[0]&&(this.state.singlePlayerMode=!0)},setBG:function(e){var t;switch(e){case"cyberpunk":t="https://lookie.jsbot.net/uploads/2clPtA.jpg",document.getElementsByTagName("body")[0].style.color="#0f8";break;case"rainbows":t="https://lookie.jsbot.net/uploads/1ECv2A.jpg",document.getElementsByTagName("body")[0].style.color="#ff0";break;default:t="https://lookie.jsbot.net/uploads/1ECv2A.jpg";break}document.getElementsByTagName("body")[0].style.backgroundImage="url("+t+")"}},mounted:function(){this.getMode(),this.state.setBG=this.setBG,this.state.createGame=this.createGame,this.state.decToAlpha=this.decToAlpha,this.state.alphaToDec=this.alphaToDec,this.state.getGameData=this.getGameData,this.state.copyToClipboard=this.copyToClipboard,this.state.actuallyStartGame=this.actuallyStartGame,this.setBG(this.state.colorMode)},watch:{"state.colorMode":function(e){this.setBG(e)}}};a("8701");Re.render=n;var Ie=Re;Object(i["a"])(Ie).mount("#app")},"65b4":function(e,t,a){"use strict";a("4a32")},8701:function(e,t,a){"use strict";a("f47d")},f47d:function(e,t,a){}});
//# sourceMappingURL=app.a8e65d18.js.map